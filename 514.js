"use strict";(self.webpackChunk_examples_base=self.webpackChunk_examples_base||[]).push([[514],{7514:function(e,t,i){i.r(t),i.d(t,{default:function(){return h}});var n=i(6976),l=i(9372),a=i(2729),r=i(1965),o=i(523),u=i(3028),s=i(5642),d=i(4218),c=[{value:1,label:"\u82f9\u679c"},{value:2,label:"\u897f\u74dc"},{value:3,label:"\u9999\u8549"},{value:4,label:"\u4e1c\u5317\u5927\u51bb\u68a8"}],f=function(e){var t=e.updateData,i=(0,a.I0)(),n=(0,a.v9)((function(e){return e})).demo,f=n.drawerVisible,p=n.tableType,h=n.queryInfo,v=n.isView,b=function(){return i({type:"demo/clean"})},m=(0,s.ZP)(["add"===p&&o.$T||"edit"===p&&o.Vx,{method:"POST",body:h}],{revalidateOnMount:!1,revalidateOnFocus:!1,onSuccess:function(e){e&&200===e.code&&(l.gU.success({title:e.message}),b())}}).mutate;return(0,d.jsx)(r.PB,{width:800,title:"add"===p?"\u65b0\u589e":"edit"===p?"\u7f16\u8f91":"\u67e5\u770b",visible:f,onClose:b,children:(0,d.jsx)(l.l0,{title:"\u57fa\u7840\u4fe1\u606f",onSubmit:function(e){e.initial,e.current;return m()},onChange:function(e){e.initial;var i=e.current;return t({queryInfo:(0,u.Z)((0,u.Z)({},h),{},{current:i})})},fields:{firstName:{labelClassName:"fieldLabel",labelStyle:{width:60},inline:!0,label:"\u59d3\u6c0f",initialValue:null===h||void 0===h?void 0:h.firstName,children:(0,d.jsx)(l.II,{disabled:v})},lastName:{labelClassName:"fieldLabel",labelStyle:{width:60},initialValue:null===h||void 0===h?void 0:h.lastName,inline:!0,label:"\u540d\u5b57",children:(0,d.jsx)(l.II,{disabled:v})},email:{labelClassName:"fieldLabel",labelStyle:{width:60},validator:function(e){return e&&e.length<2?"Password must be 8+ characters":null},initialValue:null===h||void 0===h?void 0:h.email,inline:!0,label:"Email",children:(0,d.jsx)(l.II,{disabled:v})},select:{labelClassName:"fieldLabel",labelStyle:{width:60},initialValue:null===h||void 0===h?void 0:h.select,inline:!0,label:"\u9009\u62e9\u5668",children:(0,d.jsxs)(l.Ph,{disabled:v,children:[(0,d.jsx)(l.Ph.Option,{children:"\u8bf7\u9009\u62e9"}),c.map((function(e){var t=e.label,i=e.value;return(0,d.jsx)(l.Ph.Option,{value:i,children:t},i)}))]})}},children:function(e){var t=e.fields,i=(e.state,e.canSubmit);return(0,d.jsxs)("div",{children:[(0,d.jsxs)(l.X2,{gutter:10,style:{marginBottom:10},children:[(0,d.jsx)(l.JX,{children:t.firstName}),(0,d.jsx)(l.JX,{children:t.lastName}),(0,d.jsx)(l.JX,{children:t.email})]}),(0,d.jsx)(l.X2,{gutter:10,children:(0,d.jsx)(l.JX,{children:t.select})}),!v&&(0,d.jsxs)(l.X2,{gutter:10,children:[(0,d.jsx)(l.JX,{}),(0,d.jsx)(l.JX,{fixed:!0,align:"bottom",children:(0,d.jsx)(l.zx,{disabled:!i(),type:"primary",htmlType:"submit",children:"\u63d0\u4ea4"})})]})]})}})})},p=void 0,h=function(){var e=(0,a.I0)(),t=function(t){e({type:"demo/updateState",payload:t})},i=(0,r.x6)(o.Zp,{formatData:function(e){return{total:e.data.total,data:e.data.rows||[]}},query:function(e){return console.log(e),{page:e,pageSize:10}}});function u(i,n){t({isView:"view"===i,tableType:i}),"add"===i&&t({drawerVisible:!0,queryInfo:{}}),"edit"!==i&&"view"!==i||e({type:"demo/selectById",payload:{id:null===n||void 0===n?void 0:n.id}})}return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(r.QV,{btns:[{label:"\u65b0\u589e",type:"primary",onClick:u.bind(p,"add")},{label:"\u5bfc\u51fa",type:"danger",onClick:u.bind(p,"export")},{label:"\u5bfc\u5165",type:"dark",onClick:u.bind(p,"import")}],columns:[{title:"\u59d3\u540d",key:"name",props:{widget:"input",initialValue:"zzz",widgetProps:{preIcon:"user",placeholder:"\u8f93\u5165\u7528\u6237\u540d"}}},{title:"\u5e74\u9f84",key:"age",props:{widget:"select",option:[{label:"20",value:20},{label:"10",value:10}]}},{title:"\u5730\u5740",key:"info"},{title:"\u64cd\u4f5c",key:"edit",width:98,render:function(e,t,i){return(0,d.jsxs)("div",{children:[(0,d.jsx)(l.zx,{size:"small",type:"danger",onClick:u.bind(p,"edit",i),children:"\u7f16\u8f91"}),(0,d.jsx)(l.zx,{size:"small",type:"success",onClick:u.bind(p,"view",i),children:"\u67e5\u770b"})]})}}],table:i}),(0,d.jsx)(f,{updateData:t})]})}},523:function(e,t,i){i.d(t,{ZE:function(){return a},Vx:function(){return r},$T:function(){return o},Zp:function(){return u}});var n=i(3028),l=i(5228);function a(e){return(0,l.W)("/api/demo/selectById",{method:"POST",body:(0,n.Z)({},e)})}var r="/api/demo/update",o="/api/demo/insert",u="/api/demo/selectPage"},1965:function(e,t,i){i.d(t,{PB:function(){return P},QV:function(){return V},x6:function(){return Z}});var n=i(7896),l=i(6976),a=i(9372),r=i(4218),o=function(e){var t=e.children,i=e.loading,n=void 0!==i&&i;return(0,r.jsx)(a.aN,{loading:n,style:{display:"block"},bgColor:"rgba(255, 255, 255, 0.4)",children:(0,r.jsx)(r.Fragment,{children:t})})},u=i(2867),s=i(7162),d=i.n(s),c=i(4795),f=i(5642),p=i(5228),h=(0,l.createContext)({}),v=function(){return(0,l.useContext)(h)},b=function(e){e.style;var t=e.columns,i=(0,l.useState)(1),n=(0,u.Z)(i,2),o=n[0],s=n[1],h=(0,l.useState)({data:[],total:0}),b=(0,u.Z)(h,2),m=b[0],y=b[1],x=v(),g=x.formatData,j=x.updateStore,S=x.query,k=x.key,w=x.searchValues,V=(0,l.useMemo)((function(){var e={};return t.forEach((function(t){var i;if(null!=t&&null!=(i=t.props)&&i.initialValue){var n=t.key||t.props.key;e[n]=t.props.initialValue}})),e}),[JSON.stringify(t)]),Z=(0,l.useRef)(!1),C=(0,l.useCallback)((function(){return S?S(o,!1===Z.current?V:w):{page:1,pageSize:10}}),[o,JSON.stringify(V),JSON.stringify(w)]),O=C().pageSize||10,P=(0,f.ZP)([k,{method:"POST",body:C()}],p.W,{revalidateOnFocus:!1}),N=P.data,z=P.isValidating,I=(0,l.useCallback)((0,c.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s(1);case 1:case"end":return e.stop()}}),e)}))),[]),J=(0,l.useCallback)((function(e){s(e)}),[]);return(0,l.useEffect)((function(){var e={};t.forEach((function(t){var i;if(null!=t&&null!=(i=t.props)&&i.initialValue){var n=t.key||t.props.key;e[n]=t.props.initialValue}}));var i={data:null==N?void 0:N.data,total:null==N?void 0:N.total,loading:!N||z,onSearch:I};Z.current||(Z.current=!0,i.searchValues=e),j(i),N&&y(N)}),[JSON.stringify(N),z,I,JSON.stringify(t)]),(0,r.jsx)(a.iA,{columns:t,data:g&&N?g(N).data:(null==N?void 0:N.data)||(null==m?void 0:m.data),footer:(0,r.jsx)(a.tl,{current:o,pageSize:O,total:g&&N?g(N).total:(null==N?void 0:N.total)||(null==m?void 0:m.total),divider:!0,onChange:function(e){J(e)}})})},m=i(1461),y=["option"],x=function(e){var t=e.option,i=(0,m.Z)(e,y);return(0,r.jsxs)(a.Ph,(0,n.Z)({},i,{children:[(0,r.jsx)(a.Ph.Option,{value:"",children:"\u8bf7\u9009\u62e9"}),t&&t.map((function(e){return(0,r.jsx)(a.Ph.Option,{value:e.value,children:e.label},e.value)}))]}))},g=["option"],j=function(e){var t=e.option,i=(0,m.Z)(e,g);return(0,r.jsx)(a.Ee,(0,n.Z)({},i,{children:t&&t.map((function(e){return(0,r.jsx)(a.Y8,{value:e.value,children:e.label},e.value)}))}))},S=["widgetProps","key","widget","label","initialValue"],k={input:a.II,radio:j,checkbox:a.XZ,switch:a.rs,select:x,searchSelect:a.ul,textarea:a.gx,dateInput:a.Wr,timePicker:a.jI,monthPicker:a.lH},w=function(e){var t=v(),i=t.updateStore,o=(t.reset,t.onSearch),u=e.columns,s=function(){var e={};return u.forEach((function(t){if(t.props&&Object.keys(t.props).length>0){var i=t.props,l=i.widgetProps,a=i.key,o=i.widget,u=i.label,s=i.initialValue,d=(0,m.Z)(i,S),c=t.key||a,f=k[o];e[c]=(0,n.Z)({label:t.title||u,children:(0,r.jsx)(f,(0,n.Z)({},l))},d,{initialValue:s})}})),e};(0,l.useEffect)((function(){i({searchValues:(0,n.Z)({},s().defaultValues)})}),[JSON.stringify(s().defaultValues)]);return(0,r.jsx)(a.l0,{style:{background:"#fff",paddingBottom:5},resetOnSubmit:!1,onSubmit:function(e){!function(e){var t=e.initial,l=e.current;i({searchValues:(0,n.Z)({},t,l)}),o(l)}({initial:e.initial,current:e.current})},onSubmitError:function(e){return e.filed?(0,n.Z)({},e.filed):null},fields:s(),children:function(e){var t=e.fields;e.state,e.canSubmit,e.resetForm;return(0,r.jsx)("div",{children:(0,r.jsxs)(a.X2,{gutter:12,children:[Object.keys(t).map((function(e){return(0,r.jsx)(a.JX,{fixed:!0,style:{width:"20%"},children:t[e]},e)})),(0,r.jsx)(a.JX,{style:{marginTop:31},children:(0,r.jsx)(a.zx,{type:"primary",htmlType:"submit",children:"\u67e5\u8be2"})})]})})}})},V=function(e){var t=e.table,i=e.columns,u=e.btns,s=void 0===u?[]:u,d=t.key,c=t.data,f=t.reset,p=t.refersh,v=t.updateStore,m=t.formatData,y=t.query,x=t.searchValues,g=t.loading,j=t.onSearch,S=(0,l.useMemo)((function(){return{data:[],reset:f,refersh:p,key:d,updateStore:v,formatData:m,query:y,searchValues:x,onSearch:j}}),[JSON.stringify(c),f,p,d,v,m,y,JSON.stringify(x),j]);return console.log("loading---\x3e",g),(0,r.jsx)(h.Provider,{value:S,children:(0,r.jsxs)(o,{loading:g,children:[(0,r.jsx)(w,{columns:i}),s.length>0&&(0,r.jsx)("div",{style:{marginTop:14,background:"#fff",padding:10},children:s.map((function(e,t){return(0,r.jsx)(a.zx,(0,n.Z)({style:{marginRight:5}},e,{children:e.label}),t.toString())}))}),(0,r.jsx)(b,{columns:i})]})})},Z=function(e,t){void 0===t&&(t={});var i=t,a=i.formatData,r=i.query,o=(0,l.useState)({total:1,data:[],selectChecked:[],selectCheckedRows:[],searchValues:{},loading:!1}),s=(0,u.Z)(o,2),d=s[0],c=s[1];return(0,n.Z)({key:e,reset:function(){},refersh:function(){},onSearch:function(){},formatData:a,query:r,updateStore:function(e){c((0,n.Z)({},d,e))}},d)},C=["visible","title","onClose","width","buttons","children"];function O(e){var t=e.visible,i=e.title,l=void 0===i?"":i,o=e.onClose,u=void 0===o?null:o,s=e.width,d=void 0===s?800:s,c=e.buttons,f=void 0===c?[]:c,p=e.children,h=(0,m.Z)(e,C);return(0,r.jsx)(a.dy,(0,n.Z)({title:l,isOpen:t,onClose:u&&u,size:d,bodyStyle:{padding:"0 10px 45px 10px"}},h,{footer:f.map((function(e,t){var i=e.label,n=void 0===i?"":i,l=e.onPress,o=e.show,u=void 0===o||o,s=e.loading,d=e.type,c=void 0===d?"primary":d,f=e.width,p=void 0===f?60:f,h=e.size,v=void 0===h?"default":h;return u&&(0,r.jsx)(a.zx,{style:{width:p},type:c,size:v,onClick:l&&l,loading:s,children:n},t)})),children:p}))}var P=(0,l.memo)(O)}}]);
//# sourceMappingURL=514.js.map