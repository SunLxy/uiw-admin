"use strict";(self.webpackChunk_examples_base=self.webpackChunk_examples_base||[]).push([[514],{7514:function(e,t,n){n.r(t),n.d(t,{default:function(){return p}});var i=n(6976),a=n(5924),l=n(2729),r=n(7416),o=n(523),u=n(3028),s=n(5642),d=n(4218),c=[{value:1,label:"\u82f9\u679c"},{value:2,label:"\u897f\u74dc"},{value:3,label:"\u9999\u8549"},{value:4,label:"\u4e1c\u5317\u5927\u51bb\u68a8"}],f=function(e){var t=e.updateData,n=(0,l.I0)(),i=(0,l.v9)((function(e){return e})).demo,f=i.drawerVisible,h=i.tableType,p=i.queryInfo,v=i.isView,m=function(){return n({type:"demo/clean"})},b=(0,s.ZP)(["add"===h&&o.$T||"edit"===h&&o.Vx,{method:"POST",body:p}],{revalidateOnMount:!1,revalidateOnFocus:!1,onSuccess:function(e){e&&200===e.code&&(a.gU.success({title:e.message}),m())}}).mutate;return(0,d.jsx)(r.PB,{width:800,title:"add"===h?"\u65b0\u589e":"edit"===h?"\u7f16\u8f91":"\u67e5\u770b",visible:f,onClose:m,children:(0,d.jsx)(a.l0,{title:"\u57fa\u7840\u4fe1\u606f",onSubmit:function(e){e.initial,e.current;return b()},onChange:function(e){e.initial;var n=e.current;return t({queryInfo:(0,u.Z)((0,u.Z)({},p),{},{current:n})})},fields:{firstName:{labelClassName:"fieldLabel",labelStyle:{width:60},inline:!0,label:"\u59d3\u6c0f",initialValue:null===p||void 0===p?void 0:p.firstName,children:(0,d.jsx)(a.II,{disabled:v})},lastName:{labelClassName:"fieldLabel",labelStyle:{width:60},initialValue:null===p||void 0===p?void 0:p.lastName,inline:!0,label:"\u540d\u5b57",children:(0,d.jsx)(a.II,{disabled:v})},email:{labelClassName:"fieldLabel",labelStyle:{width:60},validator:function(e){return e&&e.length<2?"Password must be 8+ characters":null},initialValue:null===p||void 0===p?void 0:p.email,inline:!0,label:"Email",children:(0,d.jsx)(a.II,{disabled:v})},select:{labelClassName:"fieldLabel",labelStyle:{width:60},initialValue:null===p||void 0===p?void 0:p.select,inline:!0,label:"\u9009\u62e9\u5668",children:(0,d.jsxs)(a.Ph,{disabled:v,children:[(0,d.jsx)(a.Ph.Option,{children:"\u8bf7\u9009\u62e9"}),c.map((function(e){var t=e.label,n=e.value;return(0,d.jsx)(a.Ph.Option,{value:n,children:t},n)}))]})}},children:function(e){var t=e.fields,n=(e.state,e.canSubmit);return(0,d.jsxs)("div",{children:[(0,d.jsxs)(a.X2,{gutter:10,style:{marginBottom:10},children:[(0,d.jsx)(a.JX,{children:t.firstName}),(0,d.jsx)(a.JX,{children:t.lastName}),(0,d.jsx)(a.JX,{children:t.email})]}),(0,d.jsx)(a.X2,{gutter:10,children:(0,d.jsx)(a.JX,{children:t.select})}),!v&&(0,d.jsxs)(a.X2,{gutter:10,children:[(0,d.jsx)(a.JX,{}),(0,d.jsx)(a.JX,{fixed:!0,align:"bottom",children:(0,d.jsx)(a.zx,{disabled:!n(),type:"primary",htmlType:"submit",children:"\u63d0\u4ea4"})})]})]})}})})},h=void 0,p=function(){var e=(0,l.I0)(),t=function(t){e({type:"demo/updateState",payload:t})},n=(0,r.x6)(o.Zp,{formatData:function(e){return{total:e.data.total,data:e.data.rows||[]}},query:function(e){return console.log(e),{page:e,pageSize:10}}});function u(n,i){t({isView:"view"===n,tableType:n}),"add"===n&&t({drawerVisible:!0,queryInfo:{}}),"edit"!==n&&"view"!==n||e({type:"demo/selectById",payload:{id:null===i||void 0===i?void 0:i.id}})}return(0,d.jsxs)(i.Fragment,{children:[(0,d.jsx)(r.QV,{btns:[{label:"\u65b0\u589e",type:"primary",onClick:u.bind(h,"add")},{label:"\u5bfc\u51fa",type:"danger",onClick:u.bind(h,"export")},{label:"\u5bfc\u5165",type:"dark",onClick:u.bind(h,"import")}],columns:[{title:"\u59d3\u540d",key:"name",props:{widget:"input",initialValue:"zzz",widgetProps:{preIcon:"user",placeholder:"\u8f93\u5165\u7528\u6237\u540d"}}},{title:"\u5e74\u9f84",key:"age",props:{widget:"select",option:[{label:"20",value:20},{label:"10",value:10}]}},{title:"\u5730\u5740",key:"info"},{title:"\u64cd\u4f5c",key:"edit",width:98,render:function(e,t,n){return(0,d.jsxs)("div",{children:[(0,d.jsx)(a.zx,{size:"small",type:"danger",onClick:u.bind(h,"edit",n),children:"\u7f16\u8f91"}),(0,d.jsx)(a.zx,{size:"small",type:"success",onClick:u.bind(h,"view",n),children:"\u67e5\u770b"})]})}}],table:n}),(0,d.jsx)(f,{updateData:t})]})}},523:function(e,t,n){n.d(t,{ZE:function(){return l},Vx:function(){return r},$T:function(){return o},Zp:function(){return u}});var i=n(3028),a=n(5228);function l(e){return(0,a.W)("/api/demo/selectById",{method:"POST",body:(0,i.Z)({},e)})}var r="/api/demo/update",o="/api/demo/insert",u="/api/demo/selectPage"},7416:function(e,t,n){n.d(t,{PB:function(){return C},QV:function(){return S},x6:function(){return k}});var i=n(7896),a=n(6976),l=n(5924),r=n(4218),o=function(e){var t=e.children,n=e.loading,i=void 0!==n&&n;return(0,r.jsx)(l.aN,{loading:i,style:{display:"block"},bgColor:"rgba(255, 255, 255, 0.4)",children:(0,r.jsx)(r.Fragment,{children:t})})},u=n(2867),s=n(7162),d=n.n(s),c=n(4795),f=n(5642),h=n(5228),p=(0,a.createContext)({}),v=function(){return(0,a.useContext)(p)},m=function(e){var t=e.style,n=e.columns,i=(0,a.useState)(1),o=(0,u.Z)(i,2),s=o[0],p=o[1],m=(0,a.useState)(!1),b=(0,u.Z)(m,2),y=b[0],x=b[1],g=v(),j=g.formatData,S=g.updateStore,k=g.query,w=g.key,V=g.searchValues,C=(0,a.useRef)(!1),O=function(e,t){return k?k(t||s,e||V):{page:t||s,pageSize:10}},P=O().pageSize||10,Z=(0,f.ZP)([w,{method:"POST",body:O()}],h.W,{revalidateOnMount:!1,revalidateOnFocus:!1}),z=Z.data,I=(Z.error,Z.mutate),N=(Z.isValidating,(0,a.useCallback)(function(){var e=(0,c.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),p(1),e.next=4,(0,h.W)(w,{method:"POST",body:O(t,1)}).then((function(e){x(!1),I(e,!1),console.log(123)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[h.W,I,JSON.stringify(V)])),J=(0,a.useCallback)(function(){var e=(0,c.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:x(!0),p(t),(0,h.W)(w,{method:"POST",body:O(void 0,t)}).then((function(e){x(!1),I(e,!1)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[h.W,I,JSON.stringify(V),s]);return(0,a.useEffect)((function(){var e={};n.forEach((function(t){var n;if(null!=t&&null!=(n=t.props)&&n.initialValue){var i=t.key||t.props.key;e[i]=t.props.initialValue}})),S({data:null==z?void 0:z.data,total:null==z?void 0:z.total,loading:y,onSearch:N}),C.current||(C.current=!0,S({searchValues:e}),x(!0),(0,h.W)(w,{method:"POST",body:O(e)}).then((function(e){x(!1),I(e,!1)})))}),[JSON.stringify(z),N,y,JSON.stringify(n)]),(0,r.jsx)(l.iA,{columns:n,data:j&&z?j(z).data:null==z?void 0:z.data,style:t,footer:(0,r.jsx)(l.tl,{current:s,pageSize:P,total:j&&z?j(z).total:null==z?void 0:z.total,divider:!0,onChange:function(e){J(e)}})})},b=n(1461),y=function(e){var t=e.option;return(0,r.jsxs)(l.Ph,{children:[(0,r.jsx)(l.Ph.Option,{value:"",children:"\u8bf7\u9009\u62e9"}),t&&t.map((function(e){return(0,r.jsx)(l.Ph.Option,{value:e.value,children:e.label},e.value)}))]})},x=["widgetProps","key","widget","label","initialValue"],g={input:l.II,radio:l.Y8,checkbox:l.XZ,switch:l.rs,select:y,textarea:l.gx,dateInput:l.Wr,timePicker:l.jI,monthPicker:l.lH},j=function(e){var t=v(),n=t.updateStore,o=(t.reset,t.onSearch),u=e.columns,s=function(){var e={};return u.forEach((function(t){if(t.props&&Object.keys(t.props).length>0){var n=t.props,a=n.widgetProps,l=n.key,o=n.widget,u=n.label,s=n.initialValue,d=(0,b.Z)(n,x),c=t.key||l,f=g[o];e[c]=(0,i.Z)({label:t.title||u,children:(0,r.jsx)(f,(0,i.Z)({},a))},d,{initialValue:s})}})),e};(0,a.useEffect)((function(){n({searchValues:(0,i.Z)({},s().defaultValues)})}),[JSON.stringify(s().defaultValues)]);return(0,r.jsx)(l.l0,{style:{background:"#fff",paddingBottom:5},resetOnSubmit:!1,onSubmit:function(e){!function(e){var t=e.initial,a=e.current;n({searchValues:(0,i.Z)({},t,a)}),o(a)}({initial:e.initial,current:e.current})},onSubmitError:function(e){return e.filed?(0,i.Z)({},e.filed):null},fields:s(),children:function(e){var t=e.fields;e.state,e.canSubmit,e.resetForm;return(0,r.jsx)("div",{children:(0,r.jsxs)(l.X2,{gutter:10,children:[Object.keys(t).map((function(e){return(0,r.jsx)(l.JX,{fixed:!0,children:t[e]},e)})),(0,r.jsx)(l.JX,{style:{marginTop:31},children:(0,r.jsx)(l.zx,{type:"primary",htmlType:"submit",children:"\u67e5\u8be2"})})]})})}})},S=function(e){var t=e.table,n=e.columns,u=e.btns,s=void 0===u?[]:u,d=t.key,c=t.data,f=t.reset,h=t.refersh,v=t.updateStore,b=t.formatData,y=t.query,x=t.searchValues,g=t.loading,S=t.onSearch,k=(0,a.useMemo)((function(){return{data:[],reset:f,refersh:h,key:d,updateStore:v,formatData:b,query:y,searchValues:x,onSearch:S}}),[JSON.stringify(c),f,h,d,v,b,y,JSON.stringify(x),S]);return(0,r.jsx)(p.Provider,{value:k,children:(0,r.jsxs)(o,{loading:g,children:[(0,r.jsx)(j,{columns:n}),s.length>0&&(0,r.jsx)("div",{style:{marginTop:14,background:"#fff",padding:10},children:s.map((function(e,t){return(0,r.jsx)(l.zx,(0,i.Z)({style:{marginRight:5}},e,{children:e.label}),t.toString())}))}),(0,r.jsx)(m,{columns:n})]})})},k=function(e,t){void 0===t&&(t={});var n=t,l=n.formatData,r=n.query,o=(0,a.useState)({total:1,data:[],selectChecked:[],selectCheckedRows:[],searchValues:{},loading:!1}),s=(0,u.Z)(o,2),d=s[0],c=s[1];return(0,i.Z)({key:e,reset:function(){},refersh:function(){},onSearch:function(){},formatData:l,query:r,updateStore:function(e){c((0,i.Z)({},d,e))}},d)},w=["visible","title","onClose","width","buttons","children"];function V(e){var t=e.visible,n=e.title,a=void 0===n?"":n,o=e.onClose,u=void 0===o?null:o,s=e.width,d=void 0===s?800:s,c=e.buttons,f=void 0===c?[]:c,h=e.children,p=(0,b.Z)(e,w);return(0,r.jsx)(l.dy,(0,i.Z)({title:a,isOpen:t,onClose:u&&u,size:d,bodyStyle:{padding:"0 10px 45px 10px"}},p,{footer:f.map((function(e,t){var n=e.label,i=void 0===n?"":n,a=e.onPress,o=e.show,u=void 0===o||o,s=e.loading,d=e.type,c=void 0===d?"primary":d,f=e.width,h=void 0===f?60:f,p=e.size,v=void 0===p?"default":p;return u&&(0,r.jsx)(l.zx,{style:{width:h},type:c,size:v,onClick:a&&a,loading:s,children:i},t)})),children:h}))}var C=(0,a.memo)(V)}}]);
//# sourceMappingURL=514.js.map