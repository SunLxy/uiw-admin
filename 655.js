"use strict";(self.webpackChunk_examples_base=self.webpackChunk_examples_base||[]).push([[655],{4655:function(e,n,r){r.r(n),r.d(n,{default:function(){return k}});var t=r(6976),a=r(9372),i=r(2729),l=r(1965),u=r(523),o=r(3028),s=r(4795),c=r(7162),d=r.n(c),f=r(7387),p=r(4218);var v=function(e){var n=e.name,r=e.type,t=e.render,i=e.initValue,l=e.rules,u=e.options,s=e.attributes,c=e.onItemChange,d=(0,f.Gc)(),v=d.control,h=d.trigger,m=(0,f.bc)({name:n,control:v,rules:l,defaultValue:i}).field,b=m.onChange,x=m.name,y=m.onBlur,g=m.value,j=m.ref,k=(0,o.Z)({name:x,ref:j,onChange:function(e){b(e),h(x),null===c||void 0===c||c(x,e)},onBlur:y(),value:g},s);return"input"===r?(0,p.jsx)("div",{style:{flex:1},children:(0,p.jsx)(a.II,(0,o.Z)({ref:j,name:x,value:g||"",onChange:function(e){b(e),h(x),null===c||void 0===c||c(x,e)},onBlur:function(){y(),h(x)}},s))}):"select"===r?(0,p.jsx)("div",{style:{flex:1},children:(0,p.jsxs)(a.Ph,(0,o.Z)((0,o.Z)({},k),{},{children:[(0,p.jsx)(a.Ph.Option,{children:(null===s||void 0===s?void 0:s.placeholder)||"\u8bf7\u9009\u62e9"}),u.map((function(e){var n=e.disabled,r=e.label,t=e.value;return(0,p.jsx)(a.Ph.Option,{disabled:n,value:t,children:r},t)}))]}))}):"radio"===r?(0,p.jsx)("div",{style:{flex:1},children:(0,p.jsx)(a.Ee,(0,o.Z)((0,o.Z)({},k),{},{children:u.map((function(e){var n=e.disabled,r=e.label,t=e.value;return(0,p.jsx)(a.Y8,{disabled:n,value:t,children:r})}))}))}):"checkbox"===r?(0,p.jsx)("div",{style:{flex:1},children:(0,p.jsx)(a.XZ.Group,(0,o.Z)((0,o.Z)({},k),{},{children:u.map((function(e){var n=e.disabled,r=e.label,t=e.value;return(0,p.jsx)(a.XZ,{disabled:n,value:t,children:r})}))}))}):"render"===r?null===t||void 0===t?void 0:t({name:x,ref:j,onChange:b,onBlur:y}):null},h=function(e){var n=e.formDatas,r=void 0===n?[]:n,t=e.onItemChange,i=e.span,l=void 0===i?3:i,u=(0,f.Gc)().formState.errors;return(0,p.jsx)("div",{className:"w-form-grid",style:{gridTemplateColumns:"repeat(".concat(l,", 1fr)")},children:r.map((function(e){var n=(0,o.Z)((0,o.Z)({},e),{},{onItemChange:t}),r=(0,p.jsx)(v,(0,o.Z)({},n));return null!==e&&void 0!==e&&e.hide?null:(0,p.jsxs)("div",{children:[(0,p.jsx)(a.X2,{children:(0,p.jsxs)(a.JX,{fixed:!0,className:"w-form-label",children:[(null===e||void 0===e?void 0:e.rules)&&(0,p.jsx)("span",{style:{color:"#ff4d4f",marginRight:5},children:"*"}),(0,p.jsx)("span",{children:null===e||void 0===e?void 0:e.label})]})}),(0,p.jsx)(a.X2,{children:r}),(0,p.jsx)(a.X2,{children:u[e.name]&&u[e.name].message&&(0,p.jsxs)(a.JX,{className:"w-form-label-error",children:[" ",u[e.name].message]})})]},e.name)}))})},m=function(e){return e&&"object"===(n=e,Object.prototype.toString.call(n).slice(8,-1).toLowerCase());var n};function b(e,n){var r=(0,f.cI)(),a=r.watch,i=r.getValues,l=r.setValue,u=r.trigger,c=r.formState.errors,v=r.reset,b=r.setError,x=r.clearErrors,y=(0,o.Z)({submitErrorCheck:!0,processValuesFunc:null},e.setOptions);return(0,t.useImperativeHandle)(n,(function(){return{setValue:function(){var e=(0,s.Z)(d().mark((function e(n,r,t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l(n,r,t));case 1:case"end":return e.stop()}}),e)})));return function(n,r,t){return e.apply(this,arguments)}}(),getValues:function(){var e=(0,s.Z)(d().mark((function e(){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!y.submitErrorCheck){e.next=5;break}return e.next=3,u();case 3:if(!m(r=c)||!Object.keys(r).length){e.next=5;break}return e.abrupt("return",null);case 5:if(n=i(),"function"!==typeof y.processValuesFunc){e.next=8;break}return e.abrupt("return",y.processValuesFunc(n));case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}var r}),e)})));return function(){return e.apply(this,arguments)}}(),errors:function(){var e=(0,s.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),reset:function(){var e=(0,s.Z)(d().mark((function e(){var n=arguments;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",v.apply(void 0,n));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),trigger:function(){var e=(0,s.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),setError:function(e,n){return b(e,n)},clearErrors:function(e){return x(e)},watch:function(){var e=(0,s.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}),[l,y,i,u,c,v,b,x,a]),(0,p.jsxs)(f.RV,(0,o.Z)((0,o.Z)({},r),{},{children:[(null===e||void 0===e?void 0:e.title)&&(0,p.jsx)("h3",{style:{marginTop:10,marginBottom:10},children:null===e||void 0===e?void 0:e.title}),(0,p.jsx)(h,(0,o.Z)({},e))]}))}var x=t.forwardRef(b),y=(0,t.forwardRef)((function(e,n){var r=e.name,t=e.onChange,i=e.onBlur;return(0,p.jsx)(a.JX,{children:(0,p.jsx)(a.XZ,{value:"checkbox",name:r,onChange:t,onBlur:i})})})),g=function(e){e.updateData;var n=(0,t.useRef)(),r=(0,i.I0)(),a=(0,i.v9)((function(e){return e})).demo,u=a.drawerVisible,c=a.tableType,f=a.queryInfo;return(0,p.jsx)(l.PB,{width:800,title:"add"===c?"\u65b0\u589e":"edit"===c?"\u7f16\u8f91":"\u67e5\u770b",visible:u,onClose:function(){return r({type:"demo/clean"})},buttons:[{label:"\u4fdd\u5b58",onPress:function(){var e=(0,s.Z)(d().mark((function e(){var t,a,i,l,u;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===n||void 0===n||null===(t=n.current)||void 0===t?void 0:t.trigger();case 2:return e.next=4,null===n||void 0===n||null===(a=n.current)||void 0===a?void 0:a.errors();case 4:return l=e.sent,e.next=7,null===n||void 0===n||null===(i=n.current)||void 0===i?void 0:i.getValues();case 7:if(u=e.sent,console.log("errors",l,"values",u),!l){e.next=11;break}return e.abrupt("return");case 11:r({type:"add"===c?"demo/insert":"demo/update",payload:u});case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}],children:(0,p.jsx)(x,{ref:n,title:"\u57fa\u7840\u4fe1\u606f",onItemChange:function(){var e=(0,s.Z)(d().mark((function e(n,r){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",console.log("name",n,"value",r));case 1:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),formDatas:[{type:"input",name:"firstName",label:"\u59d3\u6c0f",initValue:null===f||void 0===f?void 0:f.firstName,attributes:{placeholder:"\u8bf7\u8f93\u5165\u59d3\u6c0f"},rules:{required:"\u8bf7\u8f93\u5165\u59d3\u6c0f"}},{type:"input",name:"lastName",label:"\u540d\u5b57",initValue:null===f||void 0===f?void 0:f.lastName,attributes:{placeholder:"\u8bf7\u8f93\u5165\u540d\u5b57"},rules:{required:"\u8bf7\u8f93\u5165\u540d\u5b57"}},{type:"select",name:"select",label:"\u5e74\u9f84",initValue:null===f||void 0===f?void 0:f.select,options:[{value:1,label:"\u82f9\u679c"},{value:2,label:"\u897f\u74dc"},{value:3,label:"\u9999\u8549"},{value:4,label:"\u4e1c\u5317\u5927\u51bb\u68a8"}],attributes:{placeholder:"\u8bf7\u9009\u62e9\u6c34\u679c"}},{type:"render",label:"\u81ea\u5b9a\u4e49\u7ec4\u4ef6",name:"id1",rules:{required:"\u81ea\u5b9a\u4e49\u7ec4\u4ef6"},render:function(e){return(0,p.jsx)(y,(0,o.Z)({},e))}},{type:"radio",name:"id2",label:"\u6027\u522b",initValue:null===f||void 0===f?void 0:f.id2,options:[{value:1,label:"\u7537"},{value:2,label:"\u5973"},{value:3,label:"\u4eba\u5996"}]},{type:"checkbox",name:"id3",label:"\u83dc\u7cfb",initValue:null===f||void 0===f?void 0:f.id2,options:[{value:1,label:"\u56db\u5ddd\u83dc"},{value:2,label:"\u6e56\u5317\u83dc"},{value:3,label:"\u897f\u5317\u83dc"}]}]})})},j=void 0,k=function(){var e=(0,i.I0)(),n=function(n){e({type:"demo/updateState",payload:n})},r=(0,l.x6)(u.Zp,{formatData:function(e){return{total:e.data.total,data:e.data.rows||[]}},query:function(e){return console.log(e),{page:e,pageSize:10}}});function o(r,t){n({isView:"view"===r,tableType:r}),"add"===r&&n({drawerVisible:!0,queryInfo:{}}),"edit"!==r&&"view"!==r||e({type:"demo/selectById",payload:{id:null===t||void 0===t?void 0:t.id}})}return(0,p.jsxs)(t.Fragment,{children:[(0,p.jsx)(l.QV,{btns:[{label:"\u65b0\u589e",type:"primary",onClick:o.bind(j,"add")},{label:"\u5bfc\u51fa",type:"danger",onClick:o.bind(j,"export")},{label:"\u5bfc\u5165",type:"dark",onClick:o.bind(j,"import")}],columns:[{title:"\u59d3\u540d",key:"name",props:{widget:"input",initialValue:"zzz",widgetProps:{preIcon:"user",placeholder:"\u8f93\u5165\u7528\u6237\u540d"}}},{title:"\u5e74\u9f84",key:"age",props:{widget:"select",option:[{label:"20",value:20},{label:"10",value:10}]}},{title:"\u5730\u5740",key:"info"},{title:"\u64cd\u4f5c",key:"edit",width:98,render:function(e,n,r){return(0,p.jsxs)("div",{children:[(0,p.jsx)(a.zx,{size:"small",type:"danger",onClick:o.bind(j,"edit",r),children:"\u7f16\u8f91"}),(0,p.jsx)(a.zx,{size:"small",type:"success",onClick:o.bind(j,"view",r),children:"\u67e5\u770b"})]})}}],table:r}),(0,p.jsx)(g,{updateData:n})]})}},523:function(e,n,r){r.d(n,{ZE:function(){return i},Vx:function(){return u},$T:function(){return l},Zp:function(){return o}});var t=r(3028),a=r(5228);function i(e){return(0,a.W)("/api/demo/selectById",{method:"POST",body:(0,t.Z)({},e)})}function l(e){return(0,a.W)("/api/demo/insert",{method:"POST",body:(0,t.Z)({},e)})}function u(e){return(0,a.W)("/api/demo/update",{method:"POST",body:(0,t.Z)({},e)})}var o="/api/demo/selectPage"},1965:function(e,n,r){r.d(n,{PB:function(){return P},QV:function(){return S},x6:function(){return V}});var t=r(7896),a=r(6976),i=r(9372),l=r(4218),u=function(e){var n=e.children,r=e.loading,t=void 0!==r&&r;return(0,l.jsx)(i.aN,{loading:t,style:{display:"block"},bgColor:"rgba(255, 255, 255, 0.4)",children:(0,l.jsx)(l.Fragment,{children:n})})},o=r(2867),s=r(7162),c=r.n(s),d=r(4795),f=r(5642),p=r(5228),v=(0,a.createContext)({}),h=function(){return(0,a.useContext)(v)},m=function(e){e.style;var n=e.columns,r=(0,a.useState)(1),t=(0,o.Z)(r,2),u=t[0],s=t[1],v=(0,a.useState)({data:[],total:0}),m=(0,o.Z)(v,2),b=m[0],x=m[1],y=h(),g=y.formatData,j=y.updateStore,k=y.query,w=y.key,Z=y.searchValues,S=(0,a.useMemo)((function(){var e={};return n.forEach((function(n){var r;if(null!=n&&null!=(r=n.props)&&r.initialValue){var t=n.key||n.props.key;e[t]=n.props.initialValue}})),e}),[JSON.stringify(n)]),V=(0,a.useRef)(!1),C=(0,a.useCallback)((function(){return k?k(u,!1===V.current?S:Z):{page:1,pageSize:10}}),[u,JSON.stringify(S),JSON.stringify(Z)]),O=C().pageSize||10,P=(0,f.ZP)([w,{method:"POST",body:C()}],p.W,{revalidateOnFocus:!1}),I=P.data,z=P.isValidating,N=(0,a.useCallback)((0,d.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s(1);case 1:case"end":return e.stop()}}),e)}))),[]),E=(0,a.useCallback)((function(e){s(e)}),[]);return(0,a.useEffect)((function(){var e={};n.forEach((function(n){var r;if(null!=n&&null!=(r=n.props)&&r.initialValue){var t=n.key||n.props.key;e[t]=n.props.initialValue}}));var r={data:null==I?void 0:I.data,total:null==I?void 0:I.total,loading:!I||z,onSearch:N};V.current||(V.current=!0,r.searchValues=e),j(r),I&&x(I)}),[JSON.stringify(I),z,N,JSON.stringify(n)]),(0,l.jsx)(i.iA,{columns:n,data:g&&I?g(I).data:(null==I?void 0:I.data)||(null==b?void 0:b.data),footer:(0,l.jsx)(i.tl,{current:u,pageSize:O,total:g&&I?g(I).total:(null==I?void 0:I.total)||(null==b?void 0:b.total),divider:!0,onChange:function(e){E(e)}})})},b=r(1461),x=["option"],y=function(e){var n=e.option,r=(0,b.Z)(e,x);return(0,l.jsxs)(i.Ph,(0,t.Z)({},r,{children:[(0,l.jsx)(i.Ph.Option,{value:"",children:"\u8bf7\u9009\u62e9"}),n&&n.map((function(e){return(0,l.jsx)(i.Ph.Option,{value:e.value,children:e.label},e.value)}))]}))},g=["option"],j=function(e){var n=e.option,r=(0,b.Z)(e,g);return(0,l.jsx)(i.Ee,(0,t.Z)({},r,{children:n&&n.map((function(e){return(0,l.jsx)(i.Y8,{value:e.value,children:e.label},e.value)}))}))},k=["widgetProps","key","widget","label","initialValue"],w={input:i.II,radio:j,checkbox:i.XZ,switch:i.rs,select:y,searchSelect:i.ul,textarea:i.gx,dateInput:i.Wr,timePicker:i.jI,monthPicker:i.lH},Z=function(e){var n=h(),r=n.updateStore,u=(n.reset,n.onSearch),o=e.columns,s=(0,a.useMemo)((function(){var e={};return o.forEach((function(n){if(n.props&&Object.keys(n.props).length>0){var r=n.props,a=r.widgetProps,i=r.key,u=r.widget,o=r.label,s=r.initialValue,c=(0,b.Z)(r,k),d=i||n.key,f=w[u];e[d]=(0,t.Z)({label:o||n.title,children:(0,l.jsx)(f,(0,t.Z)({},a))},c,{initialValue:s})}})),e}),[JSON.stringify(o)]),c=4-Object.keys(s).length%5;return(0,l.jsx)(i.l0,{style:{background:"#fff",paddingBottom:10,marginBottom:14},resetOnSubmit:!1,onSubmit:function(e){!function(e){var n=e.initial,a=e.current;r({searchValues:(0,t.Z)({},n,a)}),u(a)}({initial:e.initial,current:e.current})},onSubmitError:function(e){return e.filed?(0,t.Z)({},e.filed):null},fields:s,children:function(e){var n=e.fields;e.state,e.canSubmit,e.resetForm;return(0,l.jsx)("div",{children:(0,l.jsxs)(i.X2,{gutter:12,children:[Object.keys(n).map((function(e){return(0,l.jsx)(i.JX,{fixed:!0,style:{width:"20%"},children:n[e]},e)})),Array(c).fill("").map((function(e,n){return(0,l.jsx)(i.JX,{fixed:!0,style:{width:"20%"}},n)})),(0,l.jsx)(i.JX,{align:"middle",children:(0,l.jsx)(i.zx,{type:"primary",htmlType:"submit",children:"\u67e5\u8be2"})})]})})}})},S=function(e){var n=e.table,r=e.columns,o=e.btns,s=void 0===o?[]:o,c=n.key,d=n.data,f=n.reset,p=n.refersh,h=n.updateStore,b=n.formatData,x=n.query,y=n.searchValues,g=n.loading,j=n.onSearch,k=(0,a.useMemo)((function(){return{data:[],reset:f,refersh:p,key:c,updateStore:h,formatData:b,query:x,searchValues:y,onSearch:j}}),[JSON.stringify(d),f,p,c,h,b,x,JSON.stringify(y),j]);return(0,l.jsx)(v.Provider,{value:k,children:(0,l.jsxs)(u,{loading:g,children:[(0,l.jsx)(Z,{columns:r}),s.length>0&&(0,l.jsx)("div",{style:{background:"#fff",padding:10},children:s.map((function(e,n){return(0,l.jsx)(i.zx,(0,t.Z)({style:{marginRight:5}},e,{children:e.label}),n.toString())}))}),(0,l.jsx)(m,{columns:r})]})})},V=function(e,n){void 0===n&&(n={});var r=n,i=r.formatData,l=r.query,u=(0,a.useState)({total:1,data:[],selectChecked:[],selectCheckedRows:[],searchValues:{},loading:!1}),s=(0,o.Z)(u,2),c=s[0],d=s[1];return(0,t.Z)({key:e,reset:function(){},refersh:function(){},onSearch:function(){},formatData:i,query:l,updateStore:function(e){d((0,t.Z)({},c,e))}},c)},C=["visible","title","onClose","width","buttons","children"];function O(e){var n=e.visible,r=e.title,a=void 0===r?"":r,u=e.onClose,o=void 0===u?null:u,s=e.width,c=void 0===s?800:s,d=e.buttons,f=void 0===d?[]:d,p=e.children,v=(0,b.Z)(e,C);return(0,l.jsx)(i.dy,(0,t.Z)({title:a,isOpen:n,onClose:o&&o,size:c,bodyStyle:{padding:"0 10px 45px 10px"}},v,{footer:f.map((function(e,n){var r=e.label,t=void 0===r?"":r,a=e.onPress,u=e.show,o=void 0===u||u,s=e.loading,c=e.type,d=void 0===c?"primary":c,f=e.width,p=void 0===f?60:f,v=e.size,h=void 0===v?"default":v;return o&&(0,l.jsx)(i.zx,{style:{width:p},type:d,size:h,onClick:a&&a,loading:s,children:t},n)})),children:p}))}var P=(0,a.memo)(O)}}]);
//# sourceMappingURL=655.js.map